import{r,j as e,L as P,$ as y,S as f}from"./app-CL8bQxlr.js";import{B as b}from"./badge-BrXa6Sqe.js";import{B as g,f as c}from"./createLucideIcon-B3Iz-h8N.js";import{C as d,a as o,b as m,c as h}from"./card-Bi6v5dWj.js";import{L as $}from"./label-DzrpR254.js";import{S as L,a as R,b as T,c as E,d as O}from"./select-Dhqvifwe.js";import{T as B,a as D,b as N,c as x,d as V,e as u}from"./table-DnsI_A3M.js";import{A}from"./app-sidebar-layout-DDY3wOZs.js";import{c as l}from"./index-BaUo0c8x.js";import{F}from"./ArrowLeftIcon-Dj3p07N0.js";import"./index-C0ENdGIb.js";import"./index-JnR7gfV7.js";import"./index-Cl3G-rYn.js";import"./x-UdVWHoq3.js";import"./truck-BB5-vzdL.js";import"./chevron-right-DjiEVRJu.js";function I({title:s,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),s?r.createElement("title",{id:t},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const H=r.forwardRef(I);function M({title:s,titleId:t,...n},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},n),s?r.createElement("title",{id:t},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const U=r.forwardRef(M);function ie({order:s,availableDrivers:t}){const[n,i]=r.useState(!1),[p,j]=r.useState(!1),v=[{title:"Dashboard",href:"/dashboard"},{title:"Orders",href:"/admin/orders"},{title:`Order #${s.id}`,href:`/admin/orders/${s.id}`}],w=a=>{switch(a){case"menunggu":return"bg-yellow-500";case"diproses":return"bg-blue-500";case"driver_telah_ditugaskan":return"bg-purple-500";case"terkirim":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},S=a=>{switch(a){case"menunggu":return"bg-yellow-500";case"diproses":return"bg-blue-500";case"terbayar":return"bg-green-500";case"gagal":return"bg-red-500";default:return"bg-gray-500"}},_=()=>{confirm("Are you sure you want to verify this payment?")&&(i(!0),f.post(`/admin/orders/${s.id}/verify-payment`,{},{onSuccess:()=>{l.success("Payment has been verified successfully"),i(!1)},onError:()=>{l.error("Failed to verify payment"),i(!1)}}))},C=()=>{const a=prompt("Please enter the reason for rejection:");a&&(j(!0),f.post(`/admin/orders/${s.id}/reject-order`,{rejection_reason:a},{onSuccess:()=>{l.success("Payment has been rejected"),j(!1)},onError:()=>{l.error("Failed to reject payment"),j(!1)}}))},k=a=>{confirm("Are you sure you want to assign this driver?")&&f.post(`/admin/orders/${s.id}/assign-driver`,{driver_id:a},{onSuccess:()=>{l.success("Driver assigned successfully")},onError:()=>{l.error("Failed to assign driver")}})};return e.jsxs(A,{breadcrumbs:v,children:[e.jsx(P,{title:`Order #${s.id}`}),e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-foreground text-2xl font-bold",children:["Order #",s.id]}),e.jsx(g,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(y,{href:"/admin/orders",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Back to Orders"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs(d,{className:"md:col-span-1",children:[e.jsx(o,{children:e.jsx(m,{children:"Order Summary"})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(b,{className:`${w(s.status)}`,children:s.status.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Status:"}),e.jsx(b,{className:`${S(s.payment_status)}`,children:s.payment_status.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Method:"}),e.jsx("span",{children:s.payment_method})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order Date:"}),e.jsx("span",{children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Update:"}),e.jsx("span",{children:new Date(s.updated_at).toLocaleString()})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal:"}),e.jsx("span",{children:c(s.total_price-s.shipping_cost)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping:"}),e.jsx("span",{children:c(s.shipping_cost)})]}),e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:c(s.total_price)})]})]})]})]}),e.jsxs(d,{className:"md:col-span-1",children:[e.jsx(o,{children:e.jsx(m,{children:"Customer Information"})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Customer Details"}),e.jsx("p",{children:s.user.name}),e.jsx("p",{children:s.user.email})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Shipping Address"}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.shipping_address})]}),s.driver&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Driver"}),e.jsx("p",{children:s.driver.name})]})]})]}),e.jsxs(d,{className:"md:col-span-1",children:[e.jsx(o,{children:e.jsx(m,{children:"Payment Verification"})}),e.jsxs(h,{className:"space-y-4",children:[s.payment_proof?e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium",children:"Payment Proof"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Click to view full image"})]}),e.jsx("a",{href:`/storage/${s.payment_proof}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:`/storage/${s.payment_proof}`,alt:"Payment Proof",className:"h-48 w-auto max-w-full rounded-md border object-contain"})}),s.payment_status==="diproses"&&e.jsxs("div",{className:"flex w-full space-x-2",children:[e.jsxs(g,{onClick:_,disabled:n||p,className:"flex-1",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),n?"Verifying...":"Verify Payment"]}),e.jsxs(g,{variant:"destructive",onClick:C,disabled:n||p,className:"flex-1",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),p?"Rejecting...":"Reject"]})]})]}):e.jsx("div",{className:"flex flex-col items-center justify-center space-y-2 rounded-md border border-dashed p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No payment proof uploaded yet"})}),s.payment_status==="terbayar"&&!s.driver&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx($,{children:"Assign Driver"}),e.jsxs(L,{onValueChange:k,children:[e.jsx(R,{children:e.jsx(T,{placeholder:"Select a driver"})}),e.jsx(E,{children:t.map(a=>e.jsx(O,{value:a.id.toString(),children:a.name},a.id))})]})]})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Order Items"})}),e.jsx(h,{children:e.jsxs(B,{children:[e.jsx(D,{children:e.jsxs(N,{children:[e.jsx(x,{children:"Product"}),e.jsx(x,{className:"text-right",children:"Qty"}),e.jsx(x,{className:"text-right",children:"Unit Price"}),e.jsx(x,{className:"text-right",children:"Total"})]})}),e.jsx(V,{children:s.order_items.map(a=>e.jsxs(N,{children:[e.jsx(u,{children:e.jsx(y,{href:`/products/${a.product.id}`,className:"font-medium hover:underline",children:a.product.name})}),e.jsx(u,{className:"text-right",children:a.quantity}),e.jsx(u,{className:"text-right",children:c(a.price)}),e.jsx(u,{className:"text-right",children:c(a.price*a.quantity)})]},a.id))})]})})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsx(m,{children:"Order Tracking History"})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:s.tracking.length===0?e.jsx("p",{className:"text-muted-foreground text-center",children:"No tracking information available"}):e.jsx("div",{className:"relative ml-4 space-y-4 border-l pt-2 pl-6",children:s.tracking.map(a=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"bg-primary absolute top-1 -left-10 h-4 w-4 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.status.replace("_"," ")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:new Date(a.created_at).toLocaleString()}),e.jsx("p",{className:"mt-1",children:a.description})]})]},a.id))})})})]})]})]})}export{ie as default};
